<main class="flex flex-col gap-2">
  <div class="flex flex-row gap-2 w-full bg-gray-600 p-2">
    <div
      (click)="wipeData()"
      class="grid place-content-center select-none p-4 rounded-full bg-red-400 hover:bg-red-500 transition-all h-10 w-fit cursor-pointer"
    >
      <div class="flex flex-row gap-2 items-center">
        <i class="ph ph-trash"></i>
        <span>Wipe Data</span>
      </div>
    </div>
    <div
      (click)="exportAndDownload()"
      class="grid place-content-center select-none p-4 rounded-full bg-green-400 hover:bg-green-500 transition-all h-10 w-fit cursor-pointer"
    >
      <div class="flex flex-row gap-2 items-center">
        <i class="ph ph-file-arrow-down"></i>
        <span>Download</span>
      </div>
    </div>
    <div
      (click)="addColumn()"
      class="grid place-content-center select-none p-4 rounded-full bg-blue-200 hover:bg-blue-300 transition-all h-10 w-fit cursor-pointer"
    >
      <div class="flex flex-row gap-2 items-center">
        <i class="ph ph-plus"></i> <span>Add Column</span>
      </div>
    </div>
  </div>
  <div
    cdkDropList
    cdkDropListOrientation="horizontal"
    (cdkDropListDropped)="drop($event)"
    #dropList="cdkDropList"
    class="w-screen h-screen overflow-auto p-2"
  >
    <form [formGroup]="form" class="flex flex-row gap-4">
      @for (column of form.controls.columns.controls; track column.controls.id;
      let i = $index) {
      <div
        class="flex flex-col divide-y w-[400px] min-w-[400px] select-none"
        cdkDrag
        [cdkDragLockAxis]="'x'"
        formArrayName="columns"
      >
        <header
          class="text-center bg-blue-500 rounded-t-md py-2 font-bold text-xl cursor-grabbing text-white flex flex-row gap-2 items-center justify-between px-4"
          cdkDragHandle
          [formGroupName]="i"
        >
          <button
            class="grid place-items-center w-[32px] h-[32px] rounded-full cursor-pointer hover:bg-blue-400 transition-all"
            (click)="removeColumn(column.controls.id.value)"
          >
            <i class="ph ph-trash"></i>
          </button>
          <input
            type="text"
            formControlName="title"
            class="p-2 bg-blue-900 text-center border rounded-md w-[300px]"
          />
        </header>
        <sch-schedule
          [columnId]="column.controls.id.value"
          (mousedown)="$event.stopPropagation()"
        />
      </div>
      }
    </form>
  </div>
</main>
